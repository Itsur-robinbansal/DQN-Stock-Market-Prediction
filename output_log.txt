Starting DQN trading agent training...
Ticker: AAPL
Period: 2020-01-01 to 2022-03-31
Training on 21 months, testing on 6 months
YF.download() has changed argument auto_adjust default to True
Successfully downloaded 566 records for AAPL
Using MultiIndex 'Close' column at index 0
Price column index: 0
Detected feature size: 22
Loaded weights from Models/dqn_AAPL.pth
Loaded weights from Models/target_dqn_AAPL.pth
Memory would be loaded for AAPL
Starting TRAINING phase...
Processing training month 2020-01-01 (1/21)
Successfully downloaded 566 records for AAPL
Using MultiIndex 'Close' column at index 0
Price column index: 0
Step 100: Updated target network, current reward: -136.47192476981976
Step 200: Updated target network, current reward: -218.01053693585098
Step 300: Updated target network, current reward: 1465.1191686603554
Month 2020-01-01 completed. Episode reward: 3112.787946238323
Memory would be saved for AAPL
Processing training month 2020-02-01 (2/21)
Successfully downloaded 566 records for AAPL
Using MultiIndex 'Close' column at index 0
Price column index: 0
RESET
Step 400: Updated target network, current reward: 3374.64380327923
Step 500: Updated target network, current reward: 3146.658167964807
Step 600: Updated target network, current reward: 3337.299153047609
Step 700: Updated target network, current reward: 4362.740213755912
Month 2020-02-01 completed. Episode reward: 398.1618983945127
Memory would be saved for AAPL
Processing training month 2020-03-01 (3/21)
Successfully downloaded 566 records for AAPL
Using MultiIndex 'Close' column at index 0
Price column index: 0
RESET
Step 800: Updated target network, current reward: 3623.0340623468064
Step 900: Updated target network, current reward: 3034.9952961996605
Step 1000: Updated target network, current reward: 3257.266317436649
Step 1100: Updated target network, current reward: 3560.739598707494
Month 2020-03-01 completed. Episode reward: -172.3758060989211
Memory would be saved for AAPL
Processing training month 2020-04-01 (4/21)
Successfully downloaded 566 records for AAPL
Using MultiIndex 'Close' column at index 0
Price column index: 0
RESET
Step 1200: Updated target network, current reward: 4161.662191155584
Step 1300: Updated target network, current reward: 4837.835139648873
Step 1400: Updated target network, current reward: 5997.664671129753
Step 1500: Updated target network, current reward: 7621.988946425008
Month 2020-04-01 completed. Episode reward: 4229.850597972221
Memory would be saved for AAPL
Processing training month 2020-05-01 (5/21)
Successfully downloaded 566 records for AAPL
Using MultiIndex 'Close' column at index 0
Price column index: 0
RESET
Step 1600: Updated target network, current reward: 8036.944764286084
Step 1700: Updated target network, current reward: 7008.507052733477
Step 1800: Updated target network, current reward: 8020.745920068447
Step 1900: Updated target network, current reward: 9336.520938090796
Month 2020-05-01 completed. Episode reward: 2516.9180918493876
Memory would be saved for AAPL
Processing training month 2020-06-01 (6/21)
Successfully downloaded 566 records for AAPL
Using MultiIndex 'Close' column at index 0
Price column index: 0
RESET
Step 2000: Updated target network, current reward: 10478.716483486669
Step 2100: Updated target network, current reward: 10248.377474275145
Step 2200: Updated target network, current reward: 11625.160798668661
Step 2300: Updated target network, current reward: 12958.340878250847
Month 2020-06-01 completed. Episode reward: 2381.482665933432
Memory would be saved for AAPL
Processing training month 2020-07-01 (7/21)
Successfully downloaded 566 records for AAPL
Using MultiIndex 'Close' column at index 0
Price column index: 0
RESET
Step 2400: Updated target network, current reward: 13688.913400174908
Step 2500: Updated target network, current reward: 11790.83734423842
Step 2600: Updated target network, current reward: 11502.070783854191
Step 2700: Updated target network, current reward: 11544.279988936709
Month 2020-07-01 completed. Episode reward: -1007.0180483795544
Memory would be saved for AAPL
Processing training month 2020-08-01 (8/21)
Successfully downloaded 566 records for AAPL
Using MultiIndex 'Close' column at index 0
Price column index: 0
RESET
Step 2800: Updated target network, current reward: 11266.03220215794
Step 2900: Updated target network, current reward: 12243.271432639325
Step 3000: Updated target network, current reward: 13359.450607970788
Step 3100: Updated target network, current reward: 15210.434136992179
Month 2020-08-01 completed. Episode reward: 3878.6541527739523
Memory would be saved for AAPL
Processing training month 2020-09-01 (9/21)
Successfully downloaded 566 records for AAPL
Using MultiIndex 'Close' column at index 0
Price column index: 0
RESET
Step 3200: Updated target network, current reward: 14915.63423772297
Step 3300: Updated target network, current reward: 14380.679908471855
Step 3400: Updated target network, current reward: 14763.955859975156
Month 2020-09-01 completed. Episode reward: 1545.8023920521534
Memory would be saved for AAPL
Processing training month 2020-10-01 (10/21)
Successfully downloaded 566 records for AAPL
Using MultiIndex 'Close' column at index 0
Price column index: 0
RESET
Step 3500: Updated target network, current reward: 16255.827663822194
Step 3600: Updated target network, current reward: 16091.642787887467
Step 3700: Updated target network, current reward: 16388.675027444766
Step 3800: Updated target network, current reward: 16151.026075057403
Month 2020-10-01 completed. Episode reward: -66.1211423472945
Memory would be saved for AAPL
Processing training month 2020-11-01 (11/21)
Successfully downloaded 566 records for AAPL
Using MultiIndex 'Close' column at index 0
Price column index: 0
RESET
Step 3900: Updated target network, current reward: 17730.78850166893
Step 4000: Updated target network, current reward: 17743.519460026786
Step 4100: Updated target network, current reward: 18720.255542048937
Step 4200: Updated target network, current reward: 18291.70156799183
Month 2020-11-01 completed. Episode reward: 824.1848883955925
Memory would be saved for AAPL
Processing training month 2020-12-01 (12/21)
Successfully downloaded 566 records for AAPL
Using MultiIndex 'Close' column at index 0
Price column index: 0
RESET
Step 4300: Updated target network, current reward: 17083.906497549462
Step 4400: Updated target network, current reward: 16418.779661303735
Step 4500: Updated target network, current reward: 17461.069451158746
Step 4600: Updated target network, current reward: 18011.65639003667
Month 2020-12-01 completed. Episode reward: 1697.476542271001
Memory would be saved for AAPL
Processing training month 2021-01-01 (13/21)
Successfully downloaded 566 records for AAPL
Using MultiIndex 'Close' column at index 0
Price column index: 0
RESET
Step 4700: Updated target network, current reward: 20338.761158173565
Step 4800: Updated target network, current reward: 21267.381010941608
Step 4900: Updated target network, current reward: 21657.02084618992
Step 5000: Updated target network, current reward: 22524.750189676914
Month 2021-01-01 completed. Episode reward: 2951.799610825795
Memory would be saved for AAPL
Processing training month 2021-02-01 (14/21)
Successfully downloaded 566 records for AAPL
Using MultiIndex 'Close' column at index 0
Price column index: 0
RESET
Step 5100: Updated target network, current reward: 23095.63439065101
Step 5200: Updated target network, current reward: 24129.154664920516
Step 5300: Updated target network, current reward: 24168.45081579325
Step 5400: Updated target network, current reward: 25741.650514767618
Month 2021-02-01 completed. Episode reward: 3585.4744014679486
Memory would be saved for AAPL
Processing training month 2021-03-01 (15/21)
Successfully downloaded 566 records for AAPL
Using MultiIndex 'Close' column at index 0
Price column index: 0
RESET
Step 5500: Updated target network, current reward: 26660.18927784405
Step 5600: Updated target network, current reward: 26211.07395966387
Step 5700: Updated target network, current reward: 29284.230233648756
Step 5800: Updated target network, current reward: 32472.728680710305
Month 2021-03-01 completed. Episode reward: 7149.611911852088
Memory would be saved for AAPL
Processing training month 2021-04-01 (16/21)
Successfully downloaded 566 records for AAPL
Using MultiIndex 'Close' column at index 0
Price column index: 0
RESET
Step 5900: Updated target network, current reward: 35861.38844347747
Step 6000: Updated target network, current reward: 37313.05985409657
Step 6100: Updated target network, current reward: 38163.537530206995
Step 6200: Updated target network, current reward: 38194.959890359096
Month 2021-04-01 completed. Episode reward: 5970.918103158747
Memory would be saved for AAPL
Processing training month 2021-05-01 (17/21)
Successfully downloaded 566 records for AAPL
Using MultiIndex 'Close' column at index 0
Price column index: 0
RESET
Step 6300: Updated target network, current reward: 39763.90823844731
Step 6400: Updated target network, current reward: 40893.078680807404
Step 6500: Updated target network, current reward: 41131.34269981449
Month 2021-05-01 completed. Episode reward: 3451.3716029042657
Memory would be saved for AAPL
Processing training month 2021-06-01 (18/21)
Successfully downloaded 566 records for AAPL
Using MultiIndex 'Close' column at index 0
Price column index: 0
RESET
Step 6600: Updated target network, current reward: 40229.87735673906
Step 6700: Updated target network, current reward: 45835.75862384767
Step 6800: Updated target network, current reward: 46550.95754605175
Step 6900: Updated target network, current reward: 47893.35913215628
Month 2021-06-01 completed. Episode reward: 7689.486283500281
Memory would be saved for AAPL
Processing training month 2021-07-01 (19/21)
Successfully downloaded 566 records for AAPL
Using MultiIndex 'Close' column at index 0
Price column index: 0
RESET
Step 7000: Updated target network, current reward: 52356.63070012593
Step 7100: Updated target network, current reward: 52563.035529190325
Step 7200: Updated target network, current reward: 58346.76052996345
Step 7300: Updated target network, current reward: 67931.09227004176
Month 2021-07-01 completed. Episode reward: 17478.561034955088
Memory would be saved for AAPL
Processing training month 2021-08-01 (20/21)
Successfully downloaded 566 records for AAPL
Using MultiIndex 'Close' column at index 0
Price column index: 0
RESET
Step 7400: Updated target network, current reward: 67647.65251607925
Step 7500: Updated target network, current reward: 69669.22553809301
Step 7600: Updated target network, current reward: 73135.6219746922
Step 7700: Updated target network, current reward: 74357.2621156185
Month 2021-08-01 completed. Episode reward: 7168.628711269487
Memory would be saved for AAPL
Processing training month 2021-09-01 (21/21)
Successfully downloaded 566 records for AAPL
Using MultiIndex 'Close' column at index 0
Price column index: 0
RESET
Step 7800: Updated target network, current reward: 74900.21478212175
Step 7900: Updated target network, current reward: 80582.81117213759
Step 8000: Updated target network, current reward: 79490.83982050887
Step 8100: Updated target network, current reward: 80195.4251124142
Month 2021-09-01 completed. Episode reward: 5746.717050305222
Memory would be saved for AAPL
Training completed. Final reward: 80532.37288929378
Starting TESTING phase...
Testing on month 2021-10-01
Successfully downloaded 566 records for AAPL
Using MultiIndex 'Close' column at index 0
Price column index: 0
Test metrics for 2021-10-01:
  Total Return: 0.1832
  Sharpe Ratio: 0.1305
  Max Drawdown: -0.7974
  Win/Loss Ratio: 1.0837
  Annualized Volatility: 0.2766
Testing on month 2021-11-01
Successfully downloaded 566 records for AAPL
Using MultiIndex 'Close' column at index 0
Price column index: 0
Test metrics for 2021-11-01:
  Total Return: 0.2245
  Sharpe Ratio: 0.1285
  Max Drawdown: -0.7974
  Win/Loss Ratio: 1.0871
  Annualized Volatility: 0.2714
Testing on month 2021-12-01
Successfully downloaded 566 records for AAPL
Using MultiIndex 'Close' column at index 0
Price column index: 0
Test metrics for 2021-12-01:
  Total Return: 0.4151
  Sharpe Ratio: 0.1379
  Max Drawdown: -0.7974
  Win/Loss Ratio: 1.0872
  Annualized Volatility: 0.2666
Testing on month 2022-01-01
Successfully downloaded 566 records for AAPL
Using MultiIndex 'Close' column at index 0
Price column index: 0
Test metrics for 2022-01-01:
  Total Return: 0.4159
  Sharpe Ratio: 0.1328
  Max Drawdown: -0.7974
  Win/Loss Ratio: 1.0853
  Annualized Volatility: 0.2627
Testing on month 2022-02-01
Successfully downloaded 566 records for AAPL
Using MultiIndex 'Close' column at index 0
Price column index: 0
Test metrics for 2022-02-01:
  Total Return: 0.6435
  Sharpe Ratio: 0.1420
  Max Drawdown: -0.7974
  Win/Loss Ratio: 1.0868
  Annualized Volatility: 0.2584
Testing on month 2022-03-01
Successfully downloaded 566 records for AAPL
Using MultiIndex 'Close' column at index 0
Price column index: 0
Test metrics for 2022-03-01:
  Total Return: 0.7187
  Sharpe Ratio: 0.1410
  Max Drawdown: -0.7974
  Win/Loss Ratio: 1.0868
  Annualized Volatility: 0.2541
Overall test performance:
  Total Return: 0.7187
  Sharpe Ratio: 0.1122
  Max Drawdown: -0.8729
  Win/Loss Ratio: 1.0860
  Annualized Volatility: 0.2677
Baseline strategy performance:
  Total Return: 0.0845
  Sharpe Ratio: 0.2833
Visualizations saved to Results/Figures/
Testing completed. Final portfolio value: 17186.82
